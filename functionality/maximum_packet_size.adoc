:am-version: latest
:source-highlighter: rouge
:rouge-style: base16.monokai

ifdef::env-github[:am-base-path: ../../main]
ifndef::env-github[:am-base-path: ../..]
ifdef::env-github[:api-base: link:https://redboltz.github.io/async_mqtt/doc/{am-version}/html]
ifndef::env-github[:api-base: link:../api]

= Maximum Packet Size

Maximum Packet Size is a way to size control for all packets.
If the node sends over the Maximum Packet Size packet, then it is protocol error. The counter part disconnect the connetion with DISCONNECT packet with Reason Code 0x95 (Packet too large).

== Notifying Maximum Packet Size

There are two independent Maximum Packet Size.

[mermaid]
ifdef::env-github[[source,mermaid]]
....
sequenceDiagram
client1->>broker: CONNECT MaximumPacketSize=10000
Note right of broker: broker can send at most 10000 bytes packet to client1
broker->>client1: CONNACK ReceiveMaximum=20000
Note left of client1: client1 can send at most 20000  bytes packet to the broker
....
